# NodePort Services for ALB Target Groups
# These services expose observability tools via NodePort for ALB routing
# NIST SC-8: Transmission Confidentiality (via ALB HTTPS)
# NIST IA-2: Identification and Authentication (via Cognito)
#
# Deploy: kubectl apply -f infra/helm/values/alb-nodeport-services.yaml
---
apiVersion: v1
kind: Service
metadata:
  name: grafana-alb
  namespace: observability
  labels:
    app: grafana
    access: alb
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: grafana
  ports:
    - name: http
      port: 3000
      targetPort: 3000
      nodePort: 30300
      protocol: TCP
---
apiVersion: v1
kind: Service
metadata:
  name: headlamp-alb
  namespace: headlamp
  labels:
    app: headlamp
    access: alb
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: headlamp
  ports:
    - name: http
      port: 80
      targetPort: 4466
      nodePort: 30446
      protocol: TCP
---
apiVersion: v1
kind: Service
metadata:
  name: kiali-alb
  namespace: istio-system
  labels:
    app: kiali
    access: alb
spec:
  type: NodePort
  selector:
    app.kubernetes.io/name: kiali
  ports:
    - name: http
      port: 20001
      targetPort: 20001
      nodePort: 30200
      protocol: TCP
