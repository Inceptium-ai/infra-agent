# Kiali Helm Values - Service Mesh Visualization
# Traffic flow visualization for Istio
# NIST AU-2: Audit Events (traffic visualization)

# CR configuration
cr:
  create: true
  name: kiali
  namespace: istio-system

  spec:
    # Authentication - anonymous (ALB + Cognito handles authentication at the edge)
    # NIST IA-2: User authentication enforced by ALB + Cognito before traffic reaches Kiali
    # Users must authenticate via Cognito OIDC; Kiali trusts pre-authenticated requests
    auth:
      strategy: anonymous

    # Deployment configuration
    deployment:
      accessible_namespaces:
        - "**"
      replicas: 1
      resources:
        requests:
          cpu: 50m
          memory: 128Mi
        limits:
          cpu: 200m
          memory: 256Mi

    # External services - connect to our stack
    external_services:
      # Prometheus for metrics
      prometheus:
        url: "http://prometheus-server.observability.svc.cluster.local:80"

      # Grafana for dashboards
      grafana:
        enabled: true
        in_cluster_url: "http://grafana.observability.svc.cluster.local:3000"
        url: "http://localhost:3000"

      # Tracing - Tempo integration
      tracing:
        enabled: true
        in_cluster_url: "http://tempo.observability.svc.cluster.local:3200"
        url: "http://localhost:3200"

    # Istio configuration
    istio_namespace: istio-system

    # Server configuration
    server:
      port: 20001
      web_fqdn: ""
      web_root: "/kiali"

    # Features - validation settings
    kiali_feature_flags:
      validations:
        ignore:
          - "KIA1201"  # Ignore missing sidecar warnings for system namespaces
