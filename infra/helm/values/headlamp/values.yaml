# Headlamp Helm Values - Kubernetes Admin Console
# NIST AC-2: Account Management (RBAC-based access)
# NIST SC-8: Transmission Confidentiality (Istio mTLS)

# Istio sidecar injection
# Label required for webhook objectSelector matching
podLabels:
  sidecar.istio.io/inject: "true"

# Annotations for injection configuration
podAnnotations:
  sidecar.istio.io/inject: "true"
  proxy.istio.io/config: '{"holdApplicationUntilProxyStarts": true}'

# Resource limits
resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 200m
    memory: 256Mi

# Service configuration
service:
  type: ClusterIP
  port: 80

# Ingress (disabled - use port-forward for dev)
ingress:
  enabled: false

# Configuration
config:
  # In-cluster mode with OIDC authentication
  inCluster: true
  pluginsDir: /headlamp/plugins
  # Base URL for ALB path-based routing
  baseURL: /headlamp
  # OIDC configuration with AWS Cognito
  # Users authenticate via Cognito, token used for K8s API via EKS OIDC
  # NIST IA-2: Per-user identification and authentication
  oidc:
    clientID: "2149h8v5bqau93lq4pcq087fm6"
    clientSecret: "d78kcdq3t870g0kg9l4uh9atq1d0r9953453nksf862e8t54mi2"
    issuerURL: "https://cognito-idp.us-east-1.amazonaws.com/us-east-1_49eiiC4Ew"
    scopes: "openid email profile"
  # Extra arguments for OIDC
  extraArgs:
    - -oidc-skip-tls-verify

# RBAC - use existing cluster admin for dev
clusterRoleBinding:
  create: true

# Service account
serviceAccount:
  create: true
  name: headlamp

# Pod security (readOnlyRootFilesystem disabled - Headlamp needs writable /tmp)
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 100
  fsGroup: 101

securityContext:
  readOnlyRootFilesystem: false  # Headlamp needs /tmp and ~/.config writable
  runAsNonRoot: true
  runAsUser: 100
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}
